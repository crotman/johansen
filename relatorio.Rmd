---
title: "Johansen"
author: "Victor"
date: "25/08/2021"
output: 
  html_document:
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(readxl)
library(janitor)
library(gt)
library(tseries)
library(vars)
library(tidyverse)


```

# Johansen

## Leitura e log

Lendo os dados


```{r}

dados <- readxl::read_excel("dados/dados.xlsx", "Plan1") %>% 
  clean_names()
  
gt(dados)


```



Passando o log nas variáveis em dinheiro e no câmbio, para que possamos avaliar as elasticidades


```{r}


dados_log <- dados %>% 
  mutate(
    across(
      .cols = c(inv, pib, taxa_de_cambio, gasto_do_governo, credito_disponivel),
      .fns = log
    )
  )

gt(dados_log)


```

## Teste de estacionariedade de cada série


### Investimento

Não podemos rejeitar a hipótese de o Investimento é não-estacionário


```{r}

adf.test(dados_log$inv)


```



### PIB

Não podemos rejeitar a hipótese de o PIB é não-estacionário


```{r}


adf.test(dados_log$pib)


```

### Juros reais

Não podemos rejeitar a hipótese de os juros reais são não-estacionários


```{r}

adf.test(dados$juros_real)

```


### Taxa de câmbio

Não podemos rejeitar a hipótese de que a taxa de cãmbio é não-estacionária


```{r}

adf.test(dados_log$taxa_de_cambio)

```

###Spread

Não podemos rejeitar a hipótese de que o spread é não-estacionário


```{r}

adf.test(dados_log$spread)

```

###Gasto do governo

Não podemos rejeitar a hipótese de que o gasto do governo é não-estacionário


```{r}

adf.test(dados_log$gasto_do_governo)

```


###Crédito disponivel



```{r}

adf.test(dados_log$credito_disponivel)

```




##Existem quantas relações de longo prazo?


vamos aplicar o teste de Johansen para saber quantas relações de longo prazo existem entre as séries

Primeiro vamos definir quanrtos lags usar. Como a resposta de um dos critérios foi 1 e os outros 2, vamos usar 1 lag por parcimônia e para facilitar a interpretação econômica.


```{r}

dados_log_sem_ano <- dados_log %>% 
  select(-ano)


vars::VARselect(y = dados_log_sem_ano)


```


Um dos testes não reveitou a hipótese de que o número de relações é <= 2. Nos dois testes rejeitamos a hipótese de que o número de relações é menor ou igual a 1. Portanto, por parcimônia, vamos usar r = 2


```{r}

resultado_johansen <- urca::ca.jo(
  type =  "trace",
  x = dados_log_sem_ano,
  ecdet = "const",
  K = 2
)


summary(resultado_johansen)


```




```{r}


resultado_johansen <- urca::ca.jo(
  type =  "eigen",
  x = dados_log_sem_ano,
  ecdet = "const",
  K = 2
)


summary(resultado_johansen)




```


##Estimando o modelo de correção de erros


```{r}


modeloVECM <- tsDyn::VECM(
  data = dados_log_sem_ano,
  lag = 1,
  r = 2,
  estim = "ML",
  
)

summary(modeloVECM)


```






















